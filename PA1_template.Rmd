---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

###Step1: Loading and preprocessing the data

```{r loading the data,warning=FALSE}
unzip("activity.zip", files = NULL, list = FALSE, overwrite = TRUE,junkpaths = FALSE, exdir = ".", unzip = "internal",setTimes = FALSE)
activity_df <- read.csv("activity.csv", header = TRUE,sep =",",stringsAsFactors = FALSE)
#closeAllConnections()
```

Checking what type of variables do we have:
```{r names}
names(activity_df)
```

Checking how many observations are there and what type of data do we have:
```{r str}
str(activity_df)
```

And let's look at the summary of data:
```{r summary}
summary(activity_df)
```

It looks like the data is tidy so we don't need to do any additional pre-processing. But some records are missing the steps data. Let's see how many of such records do we have:
```{r counting NAs,warning=FALSE}
sum(is.na(as.numeric(activity_df$steps)))
```

As we can see, there is about one fifth of observations that has missing values for the number of steps but we will decide how to replace missing values later.

For now, we will just remove all incomplete cases:
```{r complete cases}
df_cc<-activity_df[complete.cases(activity_df),]
str(df_cc)
```
As a result, the dimension of the original dataframe has been reduced.

###Step2: Calculating the mean number of steps taken per day

For this part of the assignment, we will ignore the missing values in the dataset.
```{r calculating mean,warning=FALSE}
df_mean<-aggregate(as.numeric(df_cc$steps),list(df_cc$date),mean)
#head(df$mean)
head(df_mean[,2])
```
We could have done this calculation on the original dataset (witout omitting the NAs) and we would have received the same result (one could try applying the same code to the original data set activity_df). But in this case a warning message saying that NAs have been introduced by coercion would have appeared.


Calculating the median number of steps taken per day. For this part of the assignment, we will also ignore the missing values in the dataset, i.e. apply this operation to the clean dataset.
```{r calculating median,warning=FALSE}
df_median<-aggregate(as.numeric(df_cc$steps),list(df_cc$date),median)
#head(df$median)
head(df_median[,2])
```


###Step3: Calculating the total number of steps taken per day


```{r calculating total, warning=FALSE}

df_total<-aggregate(as.numeric(df_cc$steps),list(df_cc$date),FUN=sum)
#adding appropriate labels to the data frame
colnames(df_total) <- c("date", "total number of steps")
head(df_total[,2])
# why this one doesn't work??
#library(dplyr)
#df_total2<-activity_df %>%
#     group_by(date) %>%
#     summarize(total_steps=sum(as.numeric(activity_df$steps), na.rm=TRUE))
    
#alternative
#df_t<-group_by(activity_df,date)
#df_total3<-summarize(df_t,total=sum(as.numeric(activity_df$steps),na.rm=TRUE))
#summary(df_total3)
```

The histogram representation of the results gives us the following picture:
```{r,echo=FALSE}
hist(df_total[,2],
     xlab="Numer of steps",
     ylab="Days (frequency)", 
     main ="Total number of steps taken per day",
     col = "blue",
     breaks = 30)
```

###Step 4: Defining the average daily activity pattern

In order to define the average daily activity pattern, we wil group the data by time intervals and then we all average it across all intervals, i.e. we will define the number of steps for interval number 5 across all days and then we'll divide it by the number of intervals number 5 etc.


```{r averaging by intervals}
#aggregating the data by steps, grouping by intervals and applying mean (i.e ariphmetical average)
df_cc_int<-aggregate(df_cc[,1], list(df_cc$interval), mean)
```

And then we will make a time series plot (i.e. type = "l") of the 5-minute intervals (x-axis) and the averaged number of  steps taken (y-axis):
```{r,echo=FALSE}
plot(df_cc_int[,1],df_cc_int[,2],
     type="l",
     xlab="Intervals",
     ylab="Number of steps",
     main="Average number of steps taken")
```

We can see an obvious peak on the plot, which shows the 5-minute interval, on average across all the days in the dataset, containining the maximum number  of steps. Let's define which interval was it:
```{r highest activity interval}
max_steps<-max(df_cc_int[,2])
max_int<-df_cc[df_cc[,2]==max_steps]
#Adding the labels back to the dataframe
colnames(df_cc_int)<-c("interval","steps")
max_int<-df_cc_int[df_cc_int$steps==max_steps,]
max_int
```

So we can see that it was interval number 835 that resulted in the highest average number of steps across all days.

###Step 5: Imputing missing values


Note that there are a number of days/intervals where there are missing values (coded as NA). The presence of missing days may introduce bias into some calculations or summaries of the data.

Calculate and report the total number of missing values in the dataset (i.e. the total number of rows #with NAs)

Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need #to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5#-minute interval, etc.

Create a new dataset that is equal to the original dataset but with the missing data filled in.

###Step 6: Making a histogram of the total number of steps taken each day after missing values were imputed

Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?


###Step 7: Activity patterns on weekdays vs. weekends

Are there differences in activity patterns between weekdays and weekends?
For this part the weekdays() function may be of some help here. Use the dataset with the filled-in missing values for this part.

Create a new factor variable in the dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.

Make a panel plot containing a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). 

See the README file in the GitHub repository to see an example of what this plot should look like using simulated data.
